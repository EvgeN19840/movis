function isPromise(p) {
  return p && typeof p.then === 'function'
}


function createThunkExtMiddleware(extraArgument) {
  return ({ dispatch, getState })=> next => action => {
    if ( typeof action === 'function' ) {
      const result = action(dispatch, getState, extraArgument)
      if ( isPromise(result) ) return result.then(dispatch)
      return result
    }
    return next(action)
  }
}

const thunkExt = createThunkExtMiddleware()
thunkExt.withExtraArgument = createThunkExtMiddleware

export default thunkExt
